<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word 論文頁碼排版教學</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // -----------------------------------------------------------------------------
        // Setup React from Global
        // -----------------------------------------------------------------------------
        const { useState, useEffect, useRef } = React;

        // -----------------------------------------------------------------------------
        // Internal Icon Components (SVG)
        // -----------------------------------------------------------------------------
        const IconBase = ({ children, className }) => (
            <svg 
                xmlns="http://www.w3.org/2000/svg" 
                width="24" 
                height="24" 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                strokeWidth="2" 
                strokeLinecap="round" 
                strokeLinejoin="round" 
                className={className}
            >
                {children}
            </svg>
        );

        const FileText = (props) => <IconBase {...props}><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></IconBase>;
        const Settings = (props) => <IconBase {...props}><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.39a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></IconBase>;
        const Scissors = (props) => <IconBase {...props}><circle cx="6" cy="6" r="3"></circle><circle cx="6" cy="18" r="3"></circle><line x1="20" y1="4" x2="8.12" y2="15.88"></line><line x1="14.47" y1="14.48" x2="20" y2="20"></line><line x1="8.12" y1="8.12" x2="12" y2="12"></line></IconBase>;
        const Hash = (props) => <IconBase {...props}><line x1="4" y1="9" x2="20" y2="9"></line><line x1="4" y1="15" x2="20" y2="15"></line><line x1="10" y1="3" x2="8" y2="21"></line><line x1="16" y1="3" x2="14" y2="21"></line></IconBase>;
        const List = (props) => <IconBase {...props}><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></IconBase>;
        const ArrowRight = (props) => <IconBase {...props}><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></IconBase>;
        const ArrowLeft = (props) => <IconBase {...props}><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></IconBase>;
        const CheckCircle = (props) => <IconBase {...props}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></IconBase>;
        const MousePointer2 = (props) => <IconBase {...props}><path d="m12 6.24 3.73 7.85-2.6 1.34 2.84 5.76-1.8 1.8-2.85-5.77-2.68 1.37V6.24z"></path></IconBase>;
        const BookOpen = (props) => <IconBase {...props}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></IconBase>;
        const X = (props) => <IconBase {...props}><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></IconBase>;

        // -----------------------------------------------------------------------------
        // Main Application
        // -----------------------------------------------------------------------------
        const App = () => {
          const [currentStep, setCurrentStep] = useState(0);
          const [activeTab, setActiveTab] = useState('home');
          const [showFooter, setShowFooter] = useState(false);
          const [sectionBreaks, setSectionBreaks] = useState([false, false]); // Break after Cover, Break after TOC
          const [pageNumbers, setPageNumbers] = useState({ sec1: null, sec2: null, sec3: null });
          const [tocGenerated, setTocGenerated] = useState(false);
          const [linkToPrev, setLinkToPrev] = useState({ sec2: true, sec3: true });

          // Reset state function
          const resetTutorial = () => {
            setCurrentStep(0);
            setActiveTab('home');
            setShowFooter(false);
            setSectionBreaks([false, false]);
            setPageNumbers({ sec1: null, sec2: null, sec3: null });
            setTocGenerated(false);
            setLinkToPrev({ sec2: true, sec3: true });
          };

          const steps = [
            {
              title: "歡迎來到Word論文頁碼排版教學",
              description: "在寫論文時，我們常需要：封面無頁碼、目錄用羅馬數字 (i, ii)、內文用阿拉伯數字 (1, 2)。這需要使用「分節符號」。",
              actionHint: "點擊「開始教學」",
              targetTab: null,
              instruction: "overview"
            },
            {
              title: "步驟 1：建立分節 (封面與目錄)",
              description: "首先，我們要將「封面」與「目錄」分開。請將游標放在封面頁尾，插入「下一頁」分節符號。",
              actionHint: "點擊「版面配置」頁籤",
              targetTab: 'layout',
              instruction: "click_tab_layout"
            },
            {
              title: "步驟 1：建立分節 (插入符號)",
              description: "選擇「分隔設定」中的「下一頁」。這會讓封面變成第1節，後面變成第2節。",
              actionHint: "點擊「分隔設定」按鈕",
              targetTab: 'layout',
              instruction: "add_break_1"
            },
            {
              title: "步驟 2：建立分節 (目錄與內文)",
              description: "接著，將目錄頁與內文分開。請在目錄頁尾插入另一個「下一頁」分節符號。",
              actionHint: "再次點擊「分隔設定」按鈕",
              targetTab: 'layout',
              instruction: "add_break_2"
            },
            {
              title: "步驟 3：取消節與節的連結",
              description: "現在我們有三節：封面(S1)、目錄(S2)、內文(S3)。雙擊目錄頁(S2)的頁尾來編輯它。",
              actionHint: "點擊目錄頁的「頁尾區域」",
              targetTab: 'design',
              instruction: "open_footer_s2"
            },
            {
              title: "步驟 3：取消連結 (目錄頁)",
              description: "我們要讓目錄的頁碼跟封面不連動。請取消「連結到前一節」。",
              actionHint: "點擊「連結到前一節」按鈕 (使其變灰)",
              targetTab: 'design',
              instruction: "unlink_s2"
            },
            {
              title: "步驟 4：設定目錄頁碼 (羅馬數字)",
              description: "現在為目錄(S2)加入頁碼。點選「頁碼」->「頁碼格式」。",
              actionHint: "點擊「頁碼」按鈕",
              targetTab: 'design',
              instruction: "page_num_menu_s2"
            },
            {
              title: "步驟 4：選擇格式",
              description: "選擇羅馬數字 (i, ii, iii) 並設定起始頁碼為 i。",
              actionHint: "點擊對話框中的「確定」",
              targetTab: 'design',
              instruction: "set_roman"
            },
            {
              title: "步驟 5：設定內文頁碼 (前置作業)",
              description: "接著處理內文(S3)。點擊內文頁的頁尾，並取消「連結到前一節」，這樣才不會接著羅馬數字編碼。",
              actionHint: "點擊「連結到前一節」按鈕",
              targetTab: 'design',
              instruction: "unlink_s3"
            },
            {
              title: "步驟 6：插入內文頁碼",
              description: "最後，為內文(S3)插入一般阿拉伯數字頁碼，並設定從 1 開始。",
              actionHint: "點擊「頁碼」按鈕",
              targetTab: 'design',
              instruction: "set_arabic"
            },
            {
              title: "步驟 7：生成目錄",
              description: "頁碼設定完成後，我們回到最上方生成自動目錄。",
              actionHint: "點擊「參考資料」頁籤",
              targetTab: 'references',
              instruction: "click_tab_ref"
            },
            {
              title: "步驟 7：插入目錄",
              description: "Word 會自動抓取標題樣式生成目錄。",
              actionHint: "點擊「目錄」按鈕",
              targetTab: 'references',
              instruction: "generate_toc"
            },
            {
              title: "完成！",
              description: "恭喜！你已經成功設定了論文的複雜頁碼系統。封面無碼、目錄羅馬碼、內文阿拉伯碼。",
              actionHint: "重新開始",
              targetTab: null,
              instruction: "finish"
            }
          ];

          const currentStepData = steps[currentStep];

          // Logic handlers
          const handleNextStep = () => {
            if (currentStep < steps.length - 1) {
              setCurrentStep(prev => prev + 1);
            } else {
              resetTutorial();
            }
          };

          const executeAction = (actionType) => {
            switch(actionType) {
              case 'click_tab_layout':
                setActiveTab('layout');
                break;
              case 'add_break_1':
                setSectionBreaks(prev => [true, prev[1]]);
                break;
              case 'add_break_2':
                setSectionBreaks(prev => [prev[0], true]);
                break;
              case 'open_footer_s2':
                setShowFooter(true);
                setActiveTab('design'); // Header & Footer Design tab
                break;
              case 'unlink_s2':
                setLinkToPrev(prev => ({...prev, sec2: false}));
                break;
              case 'page_num_menu_s2':
                // simulate menu open, just proceed
                break;
              case 'set_roman':
                setPageNumbers(prev => ({...prev, sec2: 'i'}));
                break;
              case 'unlink_s3':
                setLinkToPrev(prev => ({...prev, sec3: false}));
                break;
              case 'set_arabic':
                setPageNumbers(prev => ({...prev, sec3: '1'}));
                break;
              case 'click_tab_ref':
                setActiveTab('references');
                setShowFooter(false);
                break;
              case 'generate_toc':
                setTocGenerated(true);
                break;
              default:
                break;
            }
            handleNextStep();
          };

          return (
            <div className="min-h-screen bg-gray-100 flex flex-col font-sans text-gray-800">
              {/* Header / Nav */}
              <header className="bg-blue-900 text-white p-4 shadow-md flex justify-between items-center">
                <div className="flex items-center gap-2">
                  <BookOpen className="w-6 h-6" />
                  <h1 className="text-xl font-bold">Word 論文頁碼排版教學</h1>
                </div>
                <div className="text-sm bg-blue-800 px-3 py-1 rounded-full">
                  Step {currentStep + 1} of {steps.length}
                </div>
              </header>

              <main className="flex-1 flex flex-col lg:flex-row overflow-hidden">
                {/* Sidebar Instructions */}
                <aside className="w-full lg:w-1/3 bg-white border-r border-gray-200 p-6 flex flex-col justify-center relative z-10 shadow-lg">
                  <div className="mb-6">
                    <h2 className="text-2xl font-bold text-blue-700 mb-2">{currentStepData.title}</h2>
                    <p className="text-gray-600 leading-relaxed mb-4">
                      {currentStepData.description}
                    </p>
                    
                    <div className="bg-blue-50 border-l-4 border-blue-500 p-4 rounded animate-fade-in">
                      <p className="font-semibold text-blue-800 flex items-center gap-2">
                        <MousePointer2 className="w-4 h-4" />
                        任務：
                      </p>
                      <p className="text-blue-900">{currentStepData.actionHint}</p>
                    </div>
                  </div>

                  <div className="flex gap-3 mt-auto">
                     {/* Skip button for lazy users */}
                     {currentStep > 0 && currentStep < steps.length - 1 && (
                        <button 
                          onClick={() => setCurrentStep(prev => prev - 1)}
                          className="px-4 py-2 text-gray-500 hover:bg-gray-100 rounded"
                        >
                          上一步
                        </button>
                     )}
                     <button
                       onClick={() => executeAction(currentStepData.instruction)}
                       className={`flex-1 flex items-center justify-center gap-2 px-6 py-3 rounded-lg font-bold text-white transition-all transform active:scale-95
                         ${currentStep === steps.length - 1 ? 'bg-green-600 hover:bg-green-700' : 'bg-blue-600 hover:bg-blue-700 shadow-blue-200 shadow-lg'}
                       `}
                     >
                       {currentStep === 0 ? "開始教學" : currentStep === steps.length - 1 ? "重新開始" : "下一步 (或是點擊畫面)"}
                       {currentStep !== steps.length - 1 && <ArrowRight className="w-5 h-5" />}
                     </button>
                  </div>
                </aside>

                {/* Word Simulator Area */}
                <section className="flex-1 bg-gray-200 overflow-y-auto p-4 lg:p-8 flex flex-col items-center relative">
                  
                  {/* Mock Word UI Window */}
                  <div className="w-full max-w-4xl bg-white rounded-lg shadow-2xl overflow-hidden border border-gray-300 flex flex-col h-[80vh] lg:h-[85vh]">
                    
                    {/* Window Bar */}
                    <div className="bg-[#2b579a] text-white px-4 py-2 text-xs flex items-center justify-center relative">
                      <span className="absolute left-4 opacity-50">AutoSave On</span>
                      <span>畢業論文_最終版_真的不改了.docx - Word</span>
                      <div className="absolute right-4 flex gap-2">
                        <div className="w-3 h-3 rounded-full bg-yellow-400"></div>
                        <div className="w-3 h-3 rounded-full bg-green-400"></div>
                        <div className="w-3 h-3 rounded-full bg-red-400"></div>
                      </div>
                    </div>

                    {/* Ribbon (Tabs) */}
                    <div className="bg-[#f3f2f1] border-b border-gray-300">
                      <div className="flex px-2 pt-2 gap-1 text-sm">
                        {['File', 'Home', 'Insert', 'Design', 'Layout', 'References', 'Review'].map(tab => (
                          <button
                            key={tab}
                            onClick={() => {
                                // Allow clicking layout or references if that's the current task
                                const instruction = currentStepData.instruction;
                                if ((instruction === 'click_tab_layout' && tab === 'Layout') ||
                                    (instruction === 'click_tab_ref' && tab === 'References')) {
                                    executeAction(instruction);
                                } else {
                                    setActiveTab(tab.toLowerCase());
                                }
                            }}
                            className={`px-4 py-1.5 rounded-t-md transition-colors ${
                              activeTab === tab.toLowerCase() 
                                ? 'bg-white text-[#2b579a] font-bold border-t border-l border-r border-gray-300 relative -mb-[1px] z-10' 
                                : 'text-gray-600 hover:bg-gray-200'
                            }`}
                          >
                            {tab === 'File' ? '檔案' : 
                             tab === 'Home' ? '常用' : 
                             tab === 'Insert' ? '插入' : 
                             tab === 'Design' ? (showFooter ? '頁首及頁尾' : '設計') :
                             tab === 'Layout' ? '版面配置' : 
                             tab === 'References' ? '參考資料' : tab}
                          </button>
                        ))}
                      </div>
                      
                      {/* Ribbon Toolbar Content */}
                      <div className="bg-white p-2 h-24 border-b border-gray-200 flex items-center gap-4 relative">
                        {activeTab === 'home' && (
                           <div className="flex gap-4 opacity-50 grayscale select-none">
                             <div className="flex flex-col items-center"><FileText className="w-6 h-6"/><span className="text-xs mt-1">貼上</span></div>
                             <div className="w-px bg-gray-300 h-10"></div>
                             <div className="flex flex-col"><div className="bg-gray-100 w-24 h-4 mb-1"></div><div className="bg-gray-100 w-16 h-4"></div></div>
                           </div>
                        )}

                        {activeTab === 'layout' && (
                           <div className="flex gap-4">
                             <div className="flex flex-col items-center opacity-50"><Settings className="w-6 h-6"/><span className="text-xs mt-1">邊界</span></div>
                             <button 
                                onClick={() => {
                                    if(currentStepData.instruction.includes('add_break')) executeAction(currentStepData.instruction);
                                }}
                                className={`flex flex-col items-center px-3 py-1 rounded hover:bg-gray-100 ${currentStepData.instruction.includes('add_break') ? 'ring-2 ring-red-400 ring-offset-1 animate-pulse bg-yellow-50' : ''}`}
                             >
                                <Scissors className="w-6 h-6 text-gray-700"/>
                                <span className="text-xs mt-1">分隔設定</span>
                                {/* Dropdown simulation */}
                                {currentStepData.instruction.includes('add_break') && (
                                    <div className="absolute top-20 left-16 bg-white border border-gray-300 shadow-xl rounded w-48 z-50 text-left py-2 text-xs">
                                        <div className="px-3 py-1 font-bold text-gray-500">分節符號</div>
                                        <div className="px-3 py-2 bg-blue-100 text-blue-900 cursor-pointer flex justify-between items-center">
                                            下一頁 <span className="text-[10px] text-gray-500">(游標處分節)</span>
                                        </div>
                                        <div className="px-3 py-2 hover:bg-gray-100">接續本頁</div>
                                    </div>
                                )}
                             </button>
                           </div>
                        )}

                        {activeTab === 'design' && showFooter && (
                            <div className="flex gap-6 w-full">
                                <div className="flex flex-col gap-1 border-r pr-4 border-gray-300">
                                     <button 
                                        onClick={() => {
                                            if(currentStepData.instruction === 'page_num_menu_s2' || currentStepData.instruction === 'set_arabic') {
                                                // Trigger dialog via executeAction simulation
                                                if (currentStepData.instruction === 'set_arabic') executeAction('set_arabic');
                                            }
                                        }}
                                        className={`flex flex-col items-center px-2 py-1 rounded ${['page_num_menu_s2', 'set_arabic'].includes(currentStepData.instruction) ? 'ring-2 ring-red-400 bg-yellow-50 animate-pulse' : ''}`}
                                     >
                                        <Hash className="w-6 h-6 text-gray-700"/>
                                        <span className="text-xs">頁碼</span>
                                     </button>
                                     {/* Format Dialog Simulation */}
                                     {currentStepData.instruction === 'set_roman' && (
                                         <div className="absolute top-10 left-4 bg-white border border-gray-400 shadow-2xl rounded p-4 z-50 w-64">
                                             <div className="font-bold mb-2">頁碼格式</div>
                                             <div className="text-xs mb-2">數字格式: <span className="border p-1">i, ii, iii...</span></div>
                                             <div className="text-xs mb-4">起始頁碼: <span className="border p-1">i</span></div>
                                             <button onClick={() => executeAction('set_roman')} className="bg-blue-600 text-white px-4 py-1 text-xs rounded w-full">確定</button>
                                         </div>
                                     )}
                                </div>
                                <div className="flex items-center">
                                    <button 
                                        onClick={() => {
                                            if(currentStepData.instruction.includes('unlink')) executeAction(currentStepData.instruction);
                                        }}
                                        className={`flex flex-col items-center px-3 py-1 rounded gap-1
                                            ${currentStepData.instruction.includes('unlink') ? 'ring-2 ring-red-400 bg-yellow-50 animate-pulse' : ''}
                                            ${(linkToPrev.sec2 && currentStep >= 4) || (linkToPrev.sec3 && currentStep >= 8) ? 'bg-gray-200 border border-gray-400' : 'opacity-50'}
                                        `}
                                    >
                                        <div className="font-bold text-lg leading-none">∞</div>
                                        <span className="text-xs">連結到前一節</span>
                                    </button>
                                </div>
                                <div className="ml-auto flex items-center">
                                    <button onClick={() => { setShowFooter(false); setActiveTab('home'); }} className="bg-red-600 text-white px-3 py-1 rounded text-xs hover:bg-red-700">關閉頁首及頁尾</button>
                                </div>
                            </div>
                        )}

                        {activeTab === 'references' && (
                            <div className="flex gap-4">
                                <button 
                                    onClick={() => {
                                        if(currentStepData.instruction === 'generate_toc') executeAction('generate_toc');
                                    }}
                                    className={`flex flex-col items-center px-3 py-1 rounded hover:bg-gray-100 ${currentStepData.instruction === 'generate_toc' ? 'ring-2 ring-red-400 bg-yellow-50 animate-pulse' : ''}`}
                                >
                                    <List className="w-6 h-6 text-gray-700"/>
                                    <span className="text-xs mt-1">目錄</span>
                                </button>
                            </div>
                        )}
                      </div>
                    </div>

                    {/* Document Workspace */}
                    <div className="flex-1 bg-[#e3e3e3] p-8 overflow-y-scroll relative">
                      <div className="flex flex-col gap-8 items-center pb-20">
                        
                        {/* Page 1: Cover */}
                        <div className="w-[500px] h-[600px] bg-white shadow-xl relative p-12 flex flex-col items-center justify-center shrink-0 transition-all duration-500">
                            <div className="text-3xl font-bold mb-8">論文題目：網頁互動設計</div>
                            <div className="text-xl text-gray-600">指導教授：張教授</div>
                            <div className="text-xl text-gray-600 mt-2">研究生：李小明</div>
                            <div className="mt-auto text-sm text-gray-400">中華民國 114 年</div>

                            {/* Section Break Visual */}
                            {sectionBreaks[0] && (
                                <div className="absolute bottom-4 right-0 w-full border-b-2 border-dotted border-blue-400 flex justify-end px-2">
                                     <span className="text-[10px] text-blue-500 bg-white px-1">:::::: 分節符號 (下一頁) ::::::</span>
                                </div>
                            )}
                            
                            {/* Footer Area */}
                            <div className={`absolute bottom-0 left-0 w-full h-12 border-t border-transparent flex items-center justify-center text-sm text-gray-500 group
                                ${showFooter ? 'border-dashed border-gray-400 bg-gray-50' : ''}
                            `}>
                                {pageNumbers.sec1 ? pageNumbers.sec1 : (showFooter && <span className="text-gray-300 text-xs select-none">頁尾 (第1節)</span>)}
                            </div>
                        </div>

                        {/* Page 2: TOC */}
                        <div 
                            onClick={() => { if(currentStepData.instruction === 'open_footer_s2') executeAction('open_footer_s2'); }}
                            className={`w-[500px] h-[600px] bg-white shadow-xl relative p-12 shrink-0 cursor-pointer transition-all duration-300
                                ${currentStepData.instruction === 'open_footer_s2' ? 'ring-4 ring-yellow-400 scale-[1.02]' : ''}
                            `}
                        >
                            <div className="text-2xl font-bold mb-6 text-center">目錄</div>
                            {tocGenerated ? (
                                <div className="space-y-2 text-sm text-gray-700 animate-fade-in">
                                    <div className="flex justify-between border-b border-gray-100 pb-1"><span>第一章 緒論</span><span>1</span></div>
                                    <div className="flex justify-between border-b border-gray-100 pb-1"><span>第二章 文獻探討</span><span>5</span></div>
                                    <div className="flex justify-between border-b border-gray-100 pb-1"><span>第三章 研究方法</span><span>12</span></div>
                                    <div className="flex justify-between border-b border-gray-100 pb-1"><span>第四章 結論</span><span>20</span></div>
                                </div>
                            ) : (
                                <div className="space-y-4">
                                    <div className="h-4 bg-gray-100 rounded w-full"></div>
                                    <div className="h-4 bg-gray-100 rounded w-3/4"></div>
                                    <div className="h-4 bg-gray-100 rounded w-full"></div>
                                </div>
                            )}

                            {/* Section Break Visual */}
                            {sectionBreaks[1] && (
                                <div className="absolute bottom-16 right-0 w-full border-b-2 border-dotted border-blue-400 flex justify-end px-2">
                                     <span className="text-[10px] text-blue-500 bg-white px-1">:::::: 分節符號 (下一頁) ::::::</span>
                                </div>
                            )}

                            {/* Footer Area S2 */}
                            <div className={`absolute bottom-0 left-0 w-full h-16 flex flex-col items-center justify-center text-sm text-gray-500
                                 ${showFooter ? 'border-t border-dashed border-gray-400 bg-yellow-50/50' : ''}
                            `}>
                                 {showFooter && (
                                     <div className="absolute top-0 right-2 bg-gray-200 text-[10px] px-1 rounded">
                                         {linkToPrev.sec2 ? '同前 (連結到前一節)' : '已斷開連結'}
                                     </div>
                                 )}
                                 <span className="font-serif text-lg text-black">{pageNumbers.sec2 || ''}</span>
                                 {showFooter && !pageNumbers.sec2 && <span className="text-gray-300 text-xs">頁尾 (第2節)</span>}
                            </div>
                        </div>

                        {/* Page 3: Content */}
                        <div 
                            onClick={() => { if(currentStepData.instruction === 'unlink_s3') executeAction('unlink_s3'); }}
                            className="w-[500px] h-[600px] bg-white shadow-xl relative p-12 shrink-0"
                        >
                            <div className="text-2xl font-bold mb-4">第一章 緒論</div>
                            <div className="space-y-2 text-gray-600 text-sm text-justify">
                                <p>這是一段示範文字。在論文排版中，正確設定頁碼是非常重要的一環。許多學生常常因為無法正確將羅馬數字與阿拉伯數字分開而感到困擾。</p>
                                <p>透過分節符號 (Section Breaks)，我們可以將文件切割成不同的邏輯區塊，每個區塊可以擁有獨立的版面配置、頁首頁尾以及頁碼系統。</p>
                                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
                            </div>

                            {/* Footer Area S3 */}
                            <div className={`absolute bottom-0 left-0 w-full h-16 flex flex-col items-center justify-center text-sm text-gray-500
                                 ${showFooter ? 'border-t border-dashed border-gray-400 bg-green-50/50' : ''}
                            `}>
                                 {showFooter && (
                                     <div className="absolute top-0 right-2 bg-gray-200 text-[10px] px-1 rounded">
                                         {linkToPrev.sec3 ? '同前 (連結到前一節)' : '已斷開連結'}
                                     </div>
                                 )}
                                 <span className="font-serif text-lg text-black">{pageNumbers.sec3 || ''}</span>
                                 {showFooter && !pageNumbers.sec3 && <span className="text-gray-300 text-xs">頁尾 (第3節)</span>}
                            </div>

                            {/* Interaction Hint Overlay for Step S3 Unlink */}
                            {currentStepData.instruction === 'unlink_s3' && (
                                <div className="absolute inset-0 bg-black/10 flex items-end justify-center pb-20 pointer-events-none">
                                    <div className="bg-white px-4 py-2 rounded-full shadow-lg font-bold text-blue-600 animate-bounce">
                                        ↓ 點擊這裡選取內文頁尾
                                    </div>
                                </div>
                            )}
                        </div>

                      </div>
                    </div>
                  </div>

                  {/* Helper Tooltip Floating */}
                  <div className="absolute bottom-10 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white px-6 py-3 rounded-full shadow-xl pointer-events-none transition-opacity duration-300 z-50 flex items-center gap-2">
                    <CheckCircle className="w-5 h-5 text-green-400" />
                    <span>目前狀態: 第 {currentStep + 1} 步 - {currentStepData.title}</span>
                  </div>

                </section>
              </main>

              <style>{`
                @keyframes fade-in {
                  from { opacity: 0; transform: translateY(10px); }
                  to { opacity: 1; transform: translateY(0); }
                }
                .animate-fade-in {
                  animation: fade-in 0.5s ease-out forwards;
                }
              `}</style>
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>